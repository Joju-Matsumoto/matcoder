# MatCoder

## 概要
- 企画を考えるのが難しかったので，AtCoderっぽいものを再現してみました
- 競技プログラミングのWebアプリケーション

## 機能概要
- 新規登録・ログイン
- コンテストへの参加
- 問題への解答
- テストケースを用いた正誤判定
- コンテスト中の得点の変動
- コンテストの作成 (admin)
- author権限の付与 (admin)
- 問題の作成 (author)
- テストケースの作成 (author)

## 動作環境
- Python 3.8.6
- `docker run`コマンドが使える状態

## 動作確認

1. git clone
```
git clone https://github.com/Joju-Matsumoto/matcoder.git
cd matcoder
```

2. (仮想環境で)必要ライブラリインストール
```
pip install -r requirements.txt
```

3. 実行
```
python manage.py runserver
```

4. http://127.0.0.1:8000/ にアクセス

## 使い方

### 作成済みユーザー
- username: admin, password: adminpassword (superuserアカウント)
- username: test_user, password: test_password

### テストユーザーの作成
新しくユーザを作成する

1. http://127.0.0.1:8000/ にアクセス
1. 新規登録
1. ユーザー名，パスワードを入力して新規登録
1. 作成したユーザーのマイページに遷移します

### コンテストへの参加
コンテストに参加して，得点を得る

1. 上部のコンテストをクリック
1. 開催中のコンテストの中からコンテストを選択
1. 参加をクリック
1. 問題をクリック
1. 解答 (pythonプログラム)を入力
1. 提出をクリック
1. 結果(AC, WA, RE, TLE)に応じて得点が反映される

### コンテストの作成
superuser権限を持つadminがDjangoのAdminサイトを用いて作成します。

1. http://127.0.0.1:8000/ にアクセス
1. ログインをクリック
1. username: admin, password: adminpassword でログイン
1. アドミンをクリック
1. Contests，+追加をクリック
1. タイトル，概要，省略形(unique)，開始日時，終了日時，ペナルティを入力して保存をクリック
1. Authors，+追加をクリック
1. 作者，コンテストを入力して保存 (作者に設定されたユーザーのみがコンテストの問題を作成することができる)

### 問題の作成
authorに設定されたユーザーでログインし，コンテストの問題作成を行います

1. 問題作成したコンテストのauthor権限のあるユーザーでログイン
1. ページ上部のコンテストでコンテスト一覧が表示されるので，対象のコンテストをクリック
1. コンテストトップページで編集ボタンをクリック
1. 編集ページのトップでは，概要，ペナルティの編集ができる
1. 問題タブをクリック．問題番号とタイトルを入力し，新しく問題を作成
1. 問題編集ページが開くので，問題文を入力，変更をクリックすると更新される (答えの欄はダミーです．現状では特に意味はありません)
1. 問題編集ページの下部で，テストケースの作成ができる．
1. 追加をクリックしてテストケースを新規作成
1. テストケースの名前，入力，出力，サンプルフラグを入力し，保存

## 苦労した点

### djangoそのもの
- 処理の流れがわかるまではよくわからなかった
  - urlConf, view, templateの流れがわかると簡単
- 汎用的なものを多く用いて，学習コストを抑えた

### テンプレートcss全般
- CSSに対する苦手意識が拭えない
- 初めてbootstrapを使ってみた
- ここが精神的には一番キツかったです

### 細かい点
- 実際にwebアプリを作成するとなると，気にしないといけない点が多くて大変だった

## 残りの課題
- 作問
  - 作問してからのテストケースの確認作業が全くできない状態
    - 現状ではauthorがコンテストに出場しないとチェックできない
    - 面倒な手を使わないと確認してから開催という流れができない
    - authorがコンテストに出場しているのもおかしい
  - いずれかを実装
    - 答えを用いたテストケースチェック
    - 答えを用いて，テストケースの入力から出力を生成する
  - APIを用いて，テストケースをまとめて登録
- dockerの処理
  - 処理時間計測を正確に行う
    - 現状はテストケースごとに`docker run`を行っている
    - subprocessのtimeoutのみで判定している
  - 連続で提出を押すとバグる
    - 提出のクールタイムを設定する
- 提出一覧
  - テストケースの実行中にjavascriptで画面全体をリロードしている
    - Ajaxで一部のみの更新にする
- コンテスト
  - 順位付けをちゃんとする
    - コンテスト中は未確定
    - コンテスト終了時に確定させて，フィールドに保存
  - レーティング機能
